sndefine("font-loader",["utils","filefetcher","global"],(function(e,t,i){function s(e,t){return new i.Promise((function(s,n){i.setTimeout(n.bind(0,t),e)}))}return function(n,o,r){return o.querySelectorAll("style").forEach((function(e){var t=n.indexOf(e.getAttribute("data-href"));~t&&n.splice(t,1)})),i.Promise.all(n.map((function(e){return n.includes("?")&&(e+="&display=swap"),function(e){return t(e).then((function(e){return e.clone().text()}),(function(){return i.Promise.reject(e)}))}(e)}))).then((function(t){for(let[i,s]of e.entries(t)){let e=o.createElement("style");e.setAttribute("data-href",n[i]),e.textContent=s,o.head.appendChild(e)}let a=[];for(let t of e.values(r))for(let e of t.weights)a.push(i.Promise.race([s(2e3,"timed out"),o.fonts.load(`normal normal ${e} 12px/1.2 "${t.family}"`)]));return e.allSettled(a).then((function(t){for(let s of e.values(t))if("rejected"==s.status)return i.Promise.reject(s.reason);return i.Promise.resolve("ok")}))}),(function(e){return i.Promise.reject(e)}))}})),sndefine("spacer",["browser","utils","css","layout","core-sleeknote","behaviour"],(function(e,t,i,s,n,o){var r=this,a={},c={};function h(e){this.note=e,this.config=o.defaults("spacer",e.config),this.dimensions=function(){return{width:this.config.style.width,height:this.config.height}}}function l(){this.reset()}function f(e){var o=e.config,a=t.qsa(o.selector,s.viewport.parentNode)[0];if(o.DOMNode=t.insertHTML(a,t.template('<span class={className} style="{style}"></span>',{className:s.sleeknoteWrap,id:o.id,style:i.inline(o.style)}),o.insert),"bodyTop"==o.def){let e=n.custom("sleekbarForcePush");if(e){"string"!=typeof e&&(e="nav, header, #header, body > .section-header, body > *:not(span, script, iframe, anchor)");const i=t.qsa(e,a).filter((e=>{if(0!=e.offsetTop||0==e.clientHeight||e.clientWidth+20<r.innerWidth)return!1;const{position:t,visibility:i}=r.getComputedStyle(e);return("fixed"==t||"sticky"==t)&&"hidden"!=i&&(e.style.top=`${o.height}px`,!0)}));i.length&&r.addEventListener("scroll",(()=>{i.forEach((e=>{const t=o.height-r.scrollY;e.style.top=`${t<0?0:t}px`}))}),{passive:!0})}}return e}return l.prototype={reset:function(){return c={},this},set:function(e){var t=new h(e);return"close"==t.config.next&&c[t.config.id]||(c[t.config.id]=t),this},execute:function(e){var t;for(t in a)a.hasOwnProperty(t)&&(c[t]?(this.create(c[t]),delete c[t]):e||this.destroy(a[t]));for(t in c)c.hasOwnProperty(t)&&(this.create(c[t]),delete c[t]);return this},reposition:function(){var e,i;for(e in a)a.hasOwnProperty(e)&&((i=a[e]).config=t.extend(i.config,o.defaults("spacer",i.note.config)),s.css(i.config,"DOMNode",{height:i.dimensions().height}))},css:function(e,i){s.css(e.config,"DOMNode",t.extend({},i.to.animate,e.config.style))},create:function(e){var t=e.config.id;if(a[t]){var s=a[t].config.DOMNode;a[t]=e,a[t].config.DOMNode=s}else a[t]=f.call(this,e),i.reveal(a[t].config.DOMNode);var n=o.animationParameters(a[t],"close","open",a[t].note);this.css(a[t],n)},destroy:function(e){var i=e.config.id;if(a[i]){var s=o.animationParameters(a[i],"open","close",a[i].note);"shared"==a[i].config.kind?this.css(a[i],s):(t.removeNode(a[i].config.DOMNode),delete a[i])}}},l})),sndefine("cover-screen",["browser","utils","css","layout","core-sleeknote","behaviour"],(function(e,t,i,s,n,o){function r(){this.config=o.defaults("cover",{})}return r.prototype={dimensions:function(){return this.config.width=n.editor?"100%":"101vw",this.config.height=n.editor?"100%":"101vh",this.config},insert:async function(){let e="sleeknote-cover-box",t='<div style="height:100vh" onclick="void(0)"></div>';n.editor&&(t=`<div style="height:100%; width:100%; pointer-events:auto!important" id=${e}></div>`);let{wrapNode:i,docum:o}=await s.insert({parent:s.viewport,what:"cover",config:this.config,id:"sleeknote-cover",content:t,style:{}});this.config.DOMNode=i,o.documentElement.firstElementChild.insertAdjacentHTML("afterbegin","<style>body{margin:0;overflow:visible}</style>"),n.editor?this.config.boxNode=this.config.DOMNode.ownerDocument.getElementById(e):this.config.boxNode=o.documentElement},remove:function(){this.config.DOMNode&&(this.removeListener(),t.removeNode(this.config.DOMNode))},after:function(){this.config.DOMNode&&"close"==this.config.current&&i.conceal(this.config.DOMNode)},reposition:function(e,t){if(this.config.DOMNode){var i=o.needs.cover(e)?"open":"close";s.css(this.config,"DOMNode",s.createPositionStyles(o.boxParameters(this,i),"to")),this.config.current=i,this.after()}},prepare:async function(e,t){var n=this.config.current;if(this.config.DOMNode&&e!=n){if(this.config.next=e,this.params=o.animationParameters(this,n,e),this.params.width,t){let e=t.config.version>4?"rgba(0,0,0,0.6)":"radial-gradient(ellipse at center, rgba(0,0,0,0.1) 40%,rgba(0,0,0,0.6) 100%)";this.config.boxNode.style.background=e}return s.createMotion(this.params,function(e,t,n){s.css(this.config,"DOMNode",e),n&&(this.config.current=this.config.next,"close"==this.config.current&&i.conceal(this.config.DOMNode))}.bind(this))}}},r})),sndefine("orchestrator",["browser","utils","animator","core-sleeknote","spacer","behaviour","layout","cover-screen","constants","click","event-emitter","global"],(function(e,t,i,s,n,o,r,a,c,h,l,f){var g=this,d=s.custom("noIFrames"),u=s.editor||s.preview;const m=c.CORE.COMMANDS;function p(e,t,i,s){if(!(this instanceof p))return new p(e,t,i,s);e instanceof p?(this.campaign=e.campaign,this.command=e.command,this.noteName=e.noteName,this.callback=e.callback):(this.campaign=e,this.command=t,this.noteName=i,this.callback=s)}function v(){this.visibles={},this.queue=[],this.busy=!1,this.spacer=new n}return v.prototype={get empty(){return!Object.keys(this.visibles).length},get stopper(){var e;for(e in this.visibles)if(this.visibles.hasOwnProperty(e)&&this.isStopper(this.visibles[e]))return this.visibles[e]},getBoxType:function(e){return e.campaign?e.campaign.notes[e.noteName].config.type:""},isStopper:function(e){if(!e||e.campaign.isHello)return!1;if(s.editor)return!0;return"concurrent"!=(c.PROFILE.MOBILE==e.campaign.config.profile?"sequential":s.custom("notemanagermode")||"concurrent")||t.contains(this.getBoxType(e),"form","success")},addToVisibles:function(e,t){var i=this.visibles[e.id];return i?i.noteName=t:i=this.visibles[e.id]=p(e,"",t),i},removeFromVisibles:function(e){if(e=this.visibles[e.campaign.id])return delete this.visibles[e.campaign.id],e},extractCloseRequest:function(){for(var e,t=this.queue.length;t--;)if(this.queue[t].command==m.CLOSE)return e=this.queue[t],this.queue.splice(t,1),e},positionIsOccupied:function(e){var t,i;for(t in this.visibles)if(this.visibles.hasOwnProperty(t)&&(i=this.visibles[t]).campaign.config.position==e.config.position)return i},extractHello:function(){for(var e,t=this.queue.length;t--;)if((e=this.queue[t]).campaign.isHello&&e.command!=m.CLOSE&&"form"==this.getBoxType(e)&&!this.positionIsOccupied(e.campaign))return this.queue.splice(t,1),e},triggerCommand:function(e){l(e.command,{creator:c.CORE.CREATOR.API,name:e.noteName,origin:e.campaign.notes[e.noteName],trigger:"queue"})},next:async function(e,n,f){var p,v,E;if(!this.queue.length)return 0;let b=[];for(;p=this.extractCloseRequest();)b.push(p),this.removeFromVisibles(p),f||this.triggerCommand(p);if(!s.editor)for(;p=this.extractHello();)b.push(p),this.addToVisibles(p.campaign,p.noteName),this.triggerCommand(p);for(;;){if(this.queue.length){if(!e&&this.stopper&&this.isStopper(this.queue[0]))break;if(!s.editor&&this.queue[0].campaign.isHello&&(p=this.positionIsOccupied(this.queue[0].campaign))&&p.campaign!=this.queue[0].campaign)break;v=this.queue.shift();let i=t.contains(v.command,m.OPEN,m.REVEAL);if((p=this.visibles[v.campaign.id])&&p.noteName==v.noteName&&i)break;b.push(v),(p=this.visibles[v.campaign.id])&&i&&(p.command=m.CLOSE,E=p.noteName,b.push(p),this.removeFromVisibles(p)),this.isStopper(v)&&(p=this.stopper)&&(p.command=m.CLOSE,b.push(p),this.removeFromVisibles(p),u||this.add("unshift",p.campaign,m.OPEN,p.noteName)),this.addToVisibles(v.campaign,v.noteName),e||this.triggerCommand(v)}break}if(!b.length)return;var y,N=[];function O(){if(y)return N=N.concat(y),y=!1,!0}this.spacer.reset();var I=v&&v.campaign.notes[v.noteName];if(this.busy=!0,s.needBadge){if(!this.badge){let e=await g.arequire("badge");this.badge=new e,await this.badge.insert()}y=this.isStopper(v)&&o.needs.badge(I.config)?await this.badge.prepare(m.OPEN,I):await this.badge.prepare(m.CLOSE)}if(O(),I&&o.needs.cover(I.config)){if(!this.cover&&(this.cover=new a(this.viewport),await this.cover.insert(),!u)){let e=this.cover.config.DOMNode;h.listen(d?e.firstElementChild:r.doc(e),(e=>{let t=this.stopper;if(!t)return;let i=t.campaign.notes[t.noteName],s=i.doc.querySelectorAll("[data-sn-type=close], .sleeknoteMobileClose")[0];s&&i.onClick(e,s)}))}y=await this.cover.prepare(m.OPEN,I)}else{var w=this.stopper;w&&o.needs.cover(w.campaign.notes[w.noteName].config)||this.cover&&(y=await this.cover.prepare(m.CLOSE))}O();var x,M=v&&v.noteName;for(let e of t.values(b)){let t;v&&e.campaign==v.campaign&&(t=e.noteName==v.noteName?E:M),y=await e.campaign.prepareNote(e.noteName,e.command,t),x=e.campaign.notes[e.noteName],O()&&e.command!=m.CLOSE&&o.needs.spacer(x.config)&&this.spacer.set(x)}for(let e of t.keys(this.visibles))x=this.visibles[e].campaign.notes[this.visibles[e].noteName],o.needs.spacer(x.config)&&this.spacer.set(x);this.spacer.execute(),r.prepareForAnimation(N);let C=new i;return C.add(N),n?(C.playLastFrame(),this.after(b,C),1):(await new g.Promise((e=>{C.play((()=>{this.after(b,C),e()}),(()=>{l(c.CORE.EVENTS.ANIMATING,{status:!0,animator:C})}))})),2)},resolve:function(e){e&&e.callback&&g.requestAnimationFrame((()=>{e.callback("after")}))},after:function(e,i){this.busy&&(this.busy=!1,l(c.CORE.EVENTS.ANIMATING,{status:!1,animator:i}));let s={opened:[],closed:[]};for(let i of t.values(e))s[i.command==m.CLOSE?"closed":"opened"].push(i);l(c.CORE.EVENTS.VISIBLE,s);for(var n,o=e.length;o--;)(n=e[o]).campaign.afterAnimation(n.noteName),this.resolve(n);g.requestAnimationFrame((()=>{this.next(u)}))},add:function(e,t,i,s,n,o){var r=this.queue.length,a=t.config.campaignId;if(a in this.visibles&&this.visibles[a].noteName==s&&this.visibles[a].campaign.notes[s].visible==i)return;for(;r--&&this.queue[r].campaign!=t;);return~r?this.queue[r].command==m.CLOSE&&i==m.OPEN?(this.queue[e](p(t,i,s,n)),!0):(u&&(o=!0),o?(this.queue.splice(r,1),this.add(e,t,i,s,n)):"unshift"==e&&0===r):(this.queue[e](p(t,i,s,n)),!0)},indexOf:function(e){for(var t=this.queue.length;t--;)if(this.queue[t].campaign==e)return t;return-1},push:function(e,t,i,s){if(e.notes[i])return new f.Promise((n=>{this.add("push",e,t,i,n,s)&&!this.busy?this.next().finally((()=>{n()})):n()}))},close:function(e,t,i){return new f.Promise((s=>{let n=e&&this.visibles[e.id];if(n){this.add("unshift",n.campaign,"close",n.noteName,s)?this.next(1,t,i).finally((()=>{s()})):s()}else s()}))},now:function(e,t,i,s){if(e.notes[i])return new f.Promise((async n=>{this.add("unshift",e,t,i,n,s)?this.next(1).finally((()=>{n()})):n()}))},visible:function(e){return!(!e||!this.visibles[e.id])},simpleVisibles:function(){let e={};for(let t in this.visibles){let i=this.visibles[t];e[t]={campaignId:t,name:i.noteName}}return e},visibleNotes:function(){return Object.keys(this.visibles).map((function(e){var t=this.visibles[e];return t.campaign.notes[t.noteName]}),this)},waitUntilAvailable:function(){return new f.Promise((e=>{let t=()=>{this.busy?f.setTimeout(t,50):e()};t()}))}},s.expose(new v,"orchestrator")})),sndefine("note-anchored",["utils","browser","locale","note-base","layout","behaviour","note-utils","core-sleeknote","constants","css","orchestrator"],(function(e,t,i,s,n,o,r,a,c,h,l){var f=this,g=a.custom("noIFrames");let{sides:d,evenValue:u,paddingCSS:m,fixFlexboxWidths:p,PNG2SVG:v,fixVersion2DOM:E,fixDOM:b,createLabels:y}=r;const N=c.CORE.COMMANDS;return class extends s{constructor(e){super(e),this.kind="AnchoredNote",this.config.current||(this.config.current=N.CLOSE),this.config.next=this.config.current,this.config.reveal=N.OPEN}async afterInsert(){if(await super.afterInsert()){if(this.production&&this.config.version<4){let{support:e}=await f.arequire("package-legacy");e.prepare(this)}return this.setupScrolling(),!0}}get insertionTarget(){}get visible(){return!this.hidden&&this.config.next}get hidden(){return"close"==this.config.next}get sideBox(){return o.isSideBar(this.config)&&"teaser"!=this.config.type}setupScrolling(){let e=this.config.boxNode.style,i=this.config.formNode,s=o.DOMNodeScrolling(this.config,this.editor).style.maxHeight;if(this.config.profile==c.PROFILE.MOBILE&&"teaser"!=this.config.type&&!this.sideBox&&this.editor){e=this.config.boxNode.parentElement.style,e.overflow="hidden scroll",e.width=`calc(100% + ${t.systemScrollbarWidth()}px)`,e.height="100%";let i=this.dims.padding;e.padding=`${i.top||0}px ${i.right||0}px ${i.top}px ${i.left}px`}if(this.setDOMNodeStyles({maxHeight:s}),!this.sideBox||this.editor||"teaser"==this.config.type)return;let n=this.dims.bounds.other,r=this.sideBox?0:parseInt(e.paddingTop,10)||0+parseInt(e.paddingBottom,10)||0+this.dims.move.y||0+n.top+n.bottom,a="100vh";e.maxHeight=a,s=r?`calc(100vh - ${r}px)`:a,i.style.maxHeight=s;let h=i.querySelector(":scope > .flex-container-container");h&&(h.style.maxHeight=s,h.style.alignContent="center",h.querySelectorAll(":scope > .flex-container.flexbox").forEach((e=>{e.style.maxHeight=s,e.style.overflowY="auto",e.style.setProperty("pointer-events","auto","important"),e.style.minHeight=s,e.firstElementChild.style.height="fit-content",e.firstElementChild.style.minHeight=a})))}setDOMNodeStyles(t){if(n.css(this.config,"DOMNode",t),!g&&this.config.profile==c.PROFILE.MOBILE&&(this.production||"boolean"!=e.typeStr(a.preview))&&"width"in t&&this.config.boxNode){var i=Math.ceil(f.getComputedStyle(this.config.DOMNode).width);this.config.boxNode.style.width=this.config.boxNode.ownerDocument.documentElement.style.width=i}}applyConfig(e){super.applyConfig(e),this.reposition(!0),this.config.reveal=N.OPEN}afterAnimation(){super.afterAnimation(),this.hidden&&h.conceal(this.config.DOMNode)}translateRelative(){var e=this.config.relativeWidth||0,i="%";if(this.config.relativeWidth&&this.config.profile===c.PROFILE.MOBILE)this.production&&t.isLandscape()&&"teaser"==this.config.type&&this.config.relativeWidth<100&&(i="vmin");return{width:e,unit:i}}calculateDimensionsNoIframes(){var t={x:0,y:0};a.hasCustomProp("moveBox")&&(t=a.custom("moveBox")(this.config,t));var i=o.distanceFromEdges(this,!0),s={};let n="teaser"==this.config.type;if(n||this.config.profile!=c.PROFILE.MOBILE)d.forEach((function(s){if(i[s]>0){let n=e.contains(s,"left","right")?"x":"y";if(100==this.config.relativeWidth&&this.config.attach!=s&&"x"==n)return;t[n]+=u(i[s])}}),this);else{let o=this.getBoxBounds(),r=o.shadow,a=o.other,h=100==this.config.relativeWidth;if(d.forEach((function(o){var l=Math.max(a[o],r[o]);~i[o]&&(i[o]?r[o]>i[o]?l=Math.max(a[o],i[o]):l<i[o]&&(h?(this.config.attach==o&&(t.x+=i[o]-u(l)),"top"==o&&this.config.version>4&&this.config.profile==c.PROFILE.MOBILE&&!n&&(l=i[o])):t[e.contains(o,"left","right")?"x":"y"]+=i[o]-(100==this.config.relativeWidth?0:u(l))):l=0),s[o]=u(l)}),this),h){let e=Math.min(s.left,s.right);s.left=s.right=e}}var r=0,h="auto";this.config.relativeWidth&&(r=100==this.config.relativeWidth?2*t.x:(~i.right?i.right:0)+(~i.left?i.left:0),h=`calc(${this.config.relativeWidth}% - ${r}px)`);let l="auto";"teaser"!=this.config.type&&(o.isSideBar(this.config)||this.config.profile==c.PROFILE.MOBILE&&!o.isSleekBar(this.config))&&(l="100%"),this.dims={padding:s,width:h,height:l,move:t,bounds:this.getBoxBounds(),edge:i}}calculateDimensions(){if(g)return this.calculateDimensionsNoIframes();var t=this.getBoxBounds(),i=o.distanceFromEdges(this,!0),s={x:0,y:0};a.hasCustomProp("moveBox")&&(s=a.custom("moveBox")(this.config,s));var n={},r=t.shadow,l=t.other;let f="teaser"==this.config.type,p=100==this.config.relativeWidth;if(d.forEach((function(t){var o=Math.max(l[t],r[t]);~i[t]&&(i[t]?r[t]>i[t]?o=Math.max(l[t],i[t]):o<i[t]&&(p?(this.config.attach==t&&(s.x+=i[t]-u(o)),"top"==t&&this.config.version>4&&this.config.profile==c.PROFILE.MOBILE&&!f&&(o=i[t])):s[e.contains(t,"left","right")?"x":"y"]+=i[t]-(100==this.config.relativeWidth?0:u(o))):o=0),n[t]=u(o)}),this),p){let e=Math.min(n.left,n.right);n.left=n.right=e}this.editor||!this.isMobileForm||this.isHello||(n.bottom=200),e.contains(this.config.name,"badge","cover")||h.set(this.config.boxNode,m(n));var v=0,E=0;if(this.config.relativeWidth){v=100==this.config.relativeWidth?2*s.x:(~i.right?i.right:0)+(~i.left?i.left:0);var b=this.translateRelative(this.config);E=[b.width+b.unit," - "+v+"px"]}else E=u(t.width+(n.left+n.right));this.setDOMNodeStyles({width:E});var y=0,N=(v=this.config.version>1?n.top+n.bottom:0,this.config.formNode.getBoundingClientRect().height);this.config.relativeWidth&&(t.height=N),y=t.height+v,o.isPopup(this.config)&&(y=u(y)),this.setDOMNodeStyles({height:y}),this.sideBox&&(y=this.editor?"100%":"100vh"),this.dims={padding:n,move:s,width:this.config.width=E,height:this.config.height=y,bounds:t,edge:i},this.config.boundsHeight=N}reposition(e){this.calculateDimensions(),this.setDOMNodeStyles(n.createPositionStyles(o.boxParameters(this,this.config.current),"to"))}async applyFixes(){await super.applyFixes(this.doc),p.call(this,this.doc),v.call(this,this.doc),E.call(this,this.doc),await b.call(this,this.doc),y.call(this,this.doc)}async getFromTo(e){var t,i=this.config.current;switch(e){case N.CURRENT:t=this.config.current,i=N.CLOSE;break;case N.OPEN:case N.REVEAL:await this.onBeforeOpen(),t=N.OPEN;break;default:t=N.CLOSE}return t==i?{}:(this.config.next=t,t!==N.CLOSE&&(this.config.reveal=t),{from:i,to:t})}getCloseFunc(){if("form"==this.config.type&&this.config.teaser)return"openTeaser";if(this.customerPreview){if("teaser"==this.config.type)return"hideTeaserAndDontShowAgain"}else{if(this.preview){if("teaser"==this.config.type)return"openSleeknote";if("success"==this.config.type){let e=this.campaign.getType("teaser")[0];return e?(this.config.teaser=e.config.name,"openTeaser"):(this.config.form=this.campaign.getType("form")[0].config.name,"openSleeknote")}return"previewDummy"}if("teaser"==this.config.type)return"hideTeaserAndDontShowAgain"}return"hideBox"}outsideClick(e,t){if(!this.detectMobileButtonClick(e,t)){var i=this.config.formNode.getBoundingClientRect();if(!(e.clientX>=i.left&&e.clientX<=i.right&&e.clientY>=i.top&&e.clientY<=i.bottom)){var s=this.doc.querySelectorAll("[data-sn-type=close], .sleeknoteMobileClose")[0];s&&this.onClick(e,s)}}}openTeaser(e,t){if(this.campaign.teaserExist){let e=this.config.teaser;"form"==this.config.type&&"quiz"==this.campaign.config.campaignType&&(e=this.campaign.first("teaser")),this.event({command:N.OPEN,type:"teaser",name:e,eventTarget:t})}else this.hideBox(e,t)}hideBox(e,t){this.event({command:N.CLOSE,eventTarget:t})}hideTeaserAndDontShowAgain(e,t){this.production&&this.event({command:N.CLOSE,eventTarget:t})}}})),sndefine("note-bar",["utils","note-anchored","behaviour","note-utils","core-sleeknote","constants","css"],(function(e,t,i,s,n,o,r){let{qs:a,allowBackgroundClicks:c,adjustTabletSleekbar:h}=s;const l=o.CORE.COMMANDS;return class extends t{constructor(e){super(e),this.kind="BarNote",this.config.current||(this.config.current=l.CLOSE),this.config.next=this.config.current,this.config.reveal=this.config.toggle?l.MINIMIZE:l.OPEN}async afterInsert(){if(await super.afterInsert())return this.editor||(h.call(this,this.doc),c.call(this,this.doc),r.set(this.config.boxNode,"width","100%")),!0}get insertionTarget(){}setToggleIf(t){var i=this.toggleDOMNode(this.config.boxNode||t);if(i){var s=e.contains(this.config.position,o.POS.HELLO2)?0:2;r.set(i,"order",s)}}applyConfig(e){super.applyConfig(e),this.setToggleIf(),this.reposition(!0),this.config.reveal=this.config.toggle?l.MINIMIZE:l.OPEN}toggleDOMNode(e){return e||(e=this.doc),this.config.toggle&&a(e,this.config.toggle)}get isHello(){return!0}toggleToggleButton(e){var t,i=a(this.doc,'[data-sn-custom-step="toggleForm"]');i&&(i.classList.remove("toggle-arrow-up"),i.classList.remove("toggle-arrow-down"),t=this.config.position==o.POS.HELLO?"open"==e?"toggle-arrow-up":"toggle-arrow-down":"open"==e?"toggle-arrow-down":"toggle-arrow-up",i.classList.add(t))}async getFromTo(e){var t,s=this.config.current;switch(e){case l.CURRENT:t=this.config.current,s=l.CLOSE;break;case l.MAXIMIZE:t=l.OPEN;break;case l.OPEN:case l.REVEAL:await this.onBeforeOpen(),t=l.REVEAL;break;case l.MINIMIZE:t=l.MINIMIZE;break;default:t=l.CLOSE}return t==l.REVEAL&&(t=this.config.reveal||(i.isSleekBar(this.config)?l.MINIMIZE:l.OPEN)),t==s?{}:(t!=l.MINIMIZE&&s!=l.MINIMIZE||this.toggleDOMNode()||(t==l.MINIMIZE&&(t=l.OPEN),s==l.MINIMIZE&&(s=l.CLOSE)),this.config.next=t,t!==l.CLOSE&&(this.config.reveal=t),this.toggleToggleButton(t),{from:s,to:t})}toggleForm(e,t){this[(this.config.current==l.MINIMIZE?"maximize":"minimize")+"Form"](e,t)}maximizeForm(e,t){this.event({command:l.MAXIMIZE,eventTarget:t})}minimizeForm(e,t){this.event({command:l.MINIMIZE,eventTarget:t})}}})),sndefine("campaign-anchored",["browser","utils","constants","core-sleeknote","campaign-base","orchestrator","note-anchored","note-bar","font-loader","event-emitter","site-data","global","core-api"],(function(e,t,i,s,n,o,r,a,c,h,l,f,g){var d=this,u=this.document;const m=i.CORE.COMMANDS;return class p extends n{constructor({config:e}){super({config:e}),this.kind="AnchoredCampaign"}handleEvent(e){if(super.handleEvent(e),e.data.campaignId!=this.id)return;let{creator:t,command:s,name:n,ffwd:r,trigger:a}=e.data;switch(t==i.CORE.CREATOR.USER&&(this.config.smartIndex=0),s){case m.CLOSE:if("teaser"==e.data.origin.config.type&&this.tameTeaser(),"queue"==a)break;e.data.result=o.waitUntilAvailable().then((()=>o.close(this,r)));break;case m.QUEUE:if(t==i.CORE.CREATOR.API){if(this.config.campaignId in o.visibles&&"timer"!=e.data.trigger)break}e.data.result=o.push(this,m.OPEN,n);break;case m.OPEN:case m.REVEAL:case m.MAXIMIZE:case m.MINIMIZE:if("queue"==a)break;this.tameTriggers(),e.data.result=o.waitUntilAvailable().then((()=>o.now(this,s,n)))}}static async create(e){let t=new p(e);if(await t.load()||s.editor){var i=t.getType("teaser");if(i.length){t.config.hidden||(t.teaserExist=!0);var n=i[0].config.teaserDelay;n&&n>0&&!s.editor&&await new f.Promise((e=>{f.setTimeout(e,1e3*n)}))}return t}console.log(`Sleeknote campaign ${t.id} failed to preload`)}async destroy(e,i,s){!o.visible(this)||i?(o.close(this,!0,s),super.destroy(e)):(await o.close(this,!1,s),super.destroy(e)),this.onClickListener&&t.listener(u,"remove",this.onClickListener)("click")}get busy(){return o.busy}async load(){let{template:e,fontsToLoad:s}=await this.html();if(e){for(let[n,o]of t.entries(this.config.steps)){let h={config:{...o,guid:this.guid},campaign:this,html:"content"in e?t.qs(o.id,e.content):e[n],name:n,profileStr:this.profileStr,isTouch:this.isTouch},l=new(t.contains(this.config.position,i.POS.HELLO,i.POS.HELLO2)?a:r)(h);try{await l.insert(h),await c(s,l.doc,this.detectFontsRealUsage(s,l.config.boxNode)),this.notes[n]=l}catch(e){return!1}}return!0}}aftersubmit(e,t){return super.aftersubmit(e,t),this.API({command:e,noteName:t})}get isHello(){var e=this.getType("form")[0];return e&&e.isHello}ifTrigger(t){switch(t){case"scroll":if(this.config.scroll&&e.scroll.pct()>=this.config.scroll)return this.tameTriggers(t);break;case"exit":if(this.config.exit)return this.tameTriggers(t);break;case"timer":if(this.config.wait)return this.tameTriggers(t)}}launchTriggers(e){0!=this.config.wait&&(this.timer=f.setTimeout(function(){this.ifTrigger("timer")&&e("timer",this)}.bind(this),Math.max(this.config.wait+1e3,0))),this.config.onClick&&!this.onClickListener&&(this.onClickListener=function(e){this.config.onClick&&t.querySelectorClosest(e.target,this.config.onClick.selector)&&g("launch",this.config.campaignId,this.config.onClick.triggerOnce)}.bind(this),t.listener(u,"add",this.onClickListener)("click")),this.triggerOnSiteDataIf(),(t.contains(this.getType("form")[0].config.position,i.POS.HELLO,i.POS.HELLO2)||s.preview&&!this.config.wait)&&e("notification",this)}async triggerOnSiteDataIf(){if(this.config.siteData){let e=await d.arequire("float-match");for(let i of this.config.siteData.values()){e(t.findPropValue(l.getSession(this.config.NS),i.property),i.type,i.value)&&g("launch",this.config.campaignId,!1)}}}tameTeaser(){this.teaserExist=!1,this.tameTriggers()}tameTriggers(e){return this.timer&&f.clearTimeout(this.timer),this.config.hidden=!0,this.config.wait=0,this.config.exit=!1,this.config.scroll=0,!0}API({command:e,noteName:s,keep:n,ffwd:r}){let a=super.API.apply(this,arguments);if(a.handled)return a;const c=i.CORE.API;function l(e=!0){return{result:e,handled:!0}}switch(e){case c.STATUS:let n={};for(let[e,i]of t.entries(o.visibles))n[e]={campaignId:e,name:i.noteName};return l(n);case c.CLOSE:let a,g=o.visibles[this.config.campaignId];return a=g?h(m.CLOSE,{name:g.noteName,creator:i.CORE.CREATOR.API,campaignId:this.config.campaignId,origin:this.notes[g.noteName],trigger:"api",ffwd:r}):f.Promise.resolve(),l(a);case c.QUEUE:case c.OPEN:case c.MAXIMIZE:case c.MINIMIZE:if(t.contains(e,c.MAXIMIZE,c.MINIMIZE)&&!s){let e=o.visibles[this.config.campaignId];e&&(s=e.noteName)}if(s)return e==c.QUEUE&&(e=m.QUEUE),e==c.OPEN&&(e=m.OPEN),e==c.MAXIMIZE&&(e=m.MAXIMIZE),e==c.MINIMIZE&&(e=m.MINIMIZE),l(h(e,{name:s,creator:i.CORE.CREATOR.API,campaignId:this.config.campaignId,origin:this.notes[s],trigger:"api"}));break;case c.VISIBLE:let d,u=o.visible(this),p=this.getType("form")[0].config.position;return u&&(d=o.visibles[this.id].noteName),l({note:d,show:u,position:p})}return{handled:!1}}}})),sndefine("package-anchored",["campaign-anchored","orchestrator","layout"],(function(e,t,i){return{AnchoredCampaign:e,orchestrator:t,layout:i}}));